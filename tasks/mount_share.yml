- name: Install cifs-utils
  ansible.builtin.apt:
    name: cifs-utils
    state: present

- name: Create Mount Point
  ansible.builtin.file:
    path: /mnt/Hoard
    state: directory
    mode: u=rw,go=r

- name: Mount Share
  vars:
    password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          66386161373633383836393235323134646532353135633230393132306162393264666430616330
          3534393263643362333539633533353030303835303361320a383561303434643562316363646431
          64626438316661306632383463333634306239303165653231666637306565313638396336623964
          3839633531376364350a333838343737633936633263313732623461616238636232333738376630
          3134
  ansible.posix.mount:
    path: /mnt/Hoard
    src: //srv3.katoteros.org/Hoard
    fstype: cifs
    opts: "rw,nobrl,user=admin,password={{ password }},uid=michel"  # noqa: jinja[invalid]
    state: mounted
    when: pass is defined
